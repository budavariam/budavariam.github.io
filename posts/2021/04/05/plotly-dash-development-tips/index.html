<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Plotly Dash Development Tips | Mátyás Budavári</title>
<meta name=keywords content="plotly,dash,python,javascript,react,dataviz">
<meta name=description content="Last year I was working on some dash-plotly applications/dashboards.
It was confusing at first, I learned a lot during that time, I&rsquo;d like to share my gathered experience.
The docs already contain useful information, I do not wish to repeat them.
There are many example pages in github, my goal is to collect my most visited pages here,
so it&rsquo;ll be easier to start out with development.">
<meta name=author content="Mátyás Budavári">
<meta name=theme-color content="#317EFB">
<link rel=canonical href=https://budavariam.github.io/posts/2021/04/05/plotly-dash-development-tips/>
<meta name=google-site-verification content="ocrG4G5ZSn2awC0mgHAsgk2qlhd3IAXCACgWNrqJcwY">
<link href=/assets/css/stylesheet.min.8992a6674f694d99a84bca35962c31e8f7c81352f54d3e95def071e7d30507dd.css integrity="sha256-iZKmZ09pTZmoS8o1liwx6PfIE1L1TT6V3vBx59MFB90=" rel="preload stylesheet" as=style>
<script src=https://kit.fontawesome.com/68da183384.js crossorigin=anonymous></script>
<link rel=icon href=https://budavariam.github.io/favicon/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://budavariam.github.io/favicon/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://budavariam.github.io/favicon/favicon-32x32.png>
<link rel=apple-touch-icon href=https://budavariam.github.io/favicon/apple-icon-180x180.png>
<link rel=mask-icon href=https://budavariam.github.io/favicon/apple-icon-180x180.png>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-115499513-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta property="og:title" content="Plotly Dash Development Tips">
<meta property="og:description" content="Last year I was working on some dash-plotly applications/dashboards.
It was confusing at first, I learned a lot during that time, I&rsquo;d like to share my gathered experience.
The docs already contain useful information, I do not wish to repeat them.
There are many example pages in github, my goal is to collect my most visited pages here,
so it&rsquo;ll be easier to start out with development.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://budavariam.github.io/posts/2021/04/05/plotly-dash-development-tips/">
<meta property="og:image" content="https://budavariam.github.io/images/2021-04-05-plotly-dash-development-tips/cover.png"><meta property="article:published_time" content="2021-04-05T00:00:00+00:00">
<meta property="article:modified_time" content="2021-04-05T00:00:00+00:00"><meta property="og:site_name" content="Mátyás Budavári">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://budavariam.github.io/images/2021-04-05-plotly-dash-development-tips/cover.png">
<meta name=twitter:title content="Plotly Dash Development Tips">
<meta name=twitter:description content="Last year I was working on some dash-plotly applications/dashboards.
It was confusing at first, I learned a lot during that time, I&rsquo;d like to share my gathered experience.
The docs already contain useful information, I do not wish to repeat them.
There are many example pages in github, my goal is to collect my most visited pages here,
so it&rsquo;ll be easier to start out with development.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://budavariam.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Plotly Dash Development Tips","item":"https://budavariam.github.io/posts/2021/04/05/plotly-dash-development-tips/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Plotly Dash Development Tips","name":"Plotly Dash Development Tips","description":"Last year I was working on some dash-plotly applications/dashboards. It was confusing at first, I learned a lot during that time, I\u0026amp;rsquo;d like to share my gathered experience. …","keywords":["plotly","dash","python","javascript","react","dataviz"],"articleBody":"Last year I was working on some dash-plotly applications/dashboards. It was confusing at first, I learned a lot during that time, I’d like to share my gathered experience. The docs already contain useful information, I do not wish to repeat them. There are many example pages in github, my goal is to collect my most visited pages here, so it’ll be easier to start out with development.\nUseful links for getting started  dash.plotly.com/layout dash tutorials and concepts, great starting point  dash.plotly.com/basic-callbacks Info on callbacks dash.plotly.com/callback-gotchas. Note the rules of callbacks. They’re important, so I copy them here:  Callbacks require their Inputs, States, and Output to be present in the layout Callbacks require all Inputs and States to be rendered on the page A component/property pair can only be the Output of one callback All callbacks must be defined before the server starts All Dash Core Components in a layout should be registered with a callback.  legacy rule   Callback Definitions Don’t Need To Be In Lists  I prefer lists, since it’s easy to forget to add it to all return values when switching around       plotly.com/python a lot of plotly examples plotly.com/python/reference very useful reference docs on the available properties github.com/plotly/plotly.js plotly.js git repo: issues and source code are gold github.com/plotly/dash-recipes recipes for advanced usecases github.com/ucg8j/awesome-dash curated list of further reading material, libs, talks and more tutorial to clear up confusion about customdata hovertemplate optional:  dash-bootstrap-components 3rd party responsive components pandas cheatsheet    Dash clientside callbacks https://dash.plotly.com/clientside-callbacks\n Note: All examples use a single output, but we can pass an array as return value\n Some examples can be found here (test_clientside.py)\n If you do not want to update a value return window.dash_clientside.no_update If you do not want to update at all in that callback throw window.dash_clientside.PreventUpdate as an exception  Access plotly events in dash  Note: the events can only be accessed from clientside.\n This document shows what you can do with plotly events.\nIf you define a callback that is called after the figure has been created/updated, you can subscribe to the plot events\n// works if the plot's id is main-plot let plotlyGraph = document.querySelector(\"#main-plot .js-plotly-plot\"); plotlyGraph.on(\"plotly_animatingframe\", (anim) = console.log( \"Frame: %s, frameData: %o, animationSettings: %o\", anim.name, anim.frame, anim.animation ) );  Note: if you register an eventlistener multiple times it will call its callback multiple times (as you told them to)\n  Note: you can only subscribe to events if the plot has appeared in the DOM\n Unsubscribe from events Plotly.js uses a NodeJS style EventEmitter API\nSource code\ngraphDiv.removeListener(\"plotly_click\", handler); graphDiv.removeAllListeners(\"plotly_click\"); All possible events Here’s the list of all available events extracted from the source code:\n\"plotly_afterexport\"; \"plotly_afterplot\"; \"plotly_animated\"; \"plotly_animating\"; \"plotly_animatingframe\"; \"plotly_animationinterrupted\"; \"plotly_autosize\"; \"plotly_beforeexport\"; \"plotly_buttonclicked\"; \"plotly_click\"; \"plotly_clickannotation\"; \"plotly_deselect\"; \"plotly_doubleclick\"; \"plotly_framework\"; \"plotly_hover\"; \"plotly_react\"; \"plotly_redraw\"; \"plotly_relayout\"; \"plotly_relayouting\"; \"plotly_restyle\"; \"plotly_selected\"; \"plotly_selecting\"; \"plotly_sliderchange\"; \"plotly_sliderend\"; \"plotly_sliderstart\"; \"plotly_transitioned\"; \"plotly_transitioning\"; \"plotly_transitioninterrupted\"; \"plotly_unhover\"; \"plotly_update\"; \"plotly_webglcontextlost\"; My extraction method git clone git@github.com:plotly/plotly.js.git cd plotly.js ag --noheading --nogroup -o --nonumbers --nofile \"gd.emit\\('plotly_[^']+'\" | sort -u Dynamic update Docs: live-updates\nIn dash in order to change the value of a prop in a callback, you can only respond to other callbacks, and only with one value for one callback. If you periodically need to update a value, you need to have something, that continuously triggers an event (change a prop, that is used as callback input), that you can respond to.\nYou can use a ticker to call a callback periodically, you can use it’s value both in clientside and serverside callbacks\nimport dash_core_components as dcc dcc.Interval(id='my-interval', interval=100) app.clientside_callback( ClientsideFunction('clientside', 'my-updater-function'), [Output(\"change\", \"change-this-prop\")], [Input(\"my-interval\", \"n_intervals\")] ) Reference: https://dash.plotly.com/dash-core-components/interval\n Note: If you set the attributes of a DOM item from arbitrary js code, e.g. event handlers, it won’t trigger a callback.\n You can only respond to callback with one value, here’s where this component shines, it lets you periodically call a callback, and set any other value.\nDownside of interval The ticker will communicate with the server in the given interval, if you need a fast dashboard this might not be the best idea, to sync the state with the dash server. It will most likely degrade performance with more and more users.\nIf you have the option to pass down all the necessary data, with clientside callbacks and global variables in javascript code, you can create lightning fast dashboards.\nAnimations Docs: animations\nconst plotlyGraph = document.querySelector(\"#main-plot .js-plotly-plot\"); plotlyGraph.on(\"plotly_animated\", (a) = console.log(\"animation has finished plotly_animated event\", a) ); plotlyGraph.on(\"plotly_animating\", (a) = console.log(\"animation has started plotly_animating event\", a) ); plotlyGraph.on(\"plotly_animatingframe\", (a) = console.log(\"call on each frame plotly_animatingframe event\", a) ); plotlyGraph.on(\"plotly_animationinterrupted\", (a) = console.log(\"pause btn clicked plotly_animationinterrupted event\", a) ); State vs Input Docs: forum post\nThe @app.callback decorator can have 3 parameters, Inputs, Outputs, and States. Input triggers a refresh on change, State does not, only use the latest version of the value, that is available when the callback runs.\nWhen you load the page for the first time, all callbacks will be called with the initial value. If you calculate default values in the beginning, and you want to use them in an other callback, then if you add them as an Input, it will wait for that data, BUT if you add it as a State it won’t wait for it, it will use the data that has been calculated until that point that your callback has been called.\n@app.callback( output=[ # the result of the callback will set the given prop on the given element  Output('my-link', 'href'), ], inputs=[ # if it changes it triggers a callback call Input('url', 'search'), ], state=[ # if it changes it does not trigger a callback call # but the value is available as a prameter State('strava-auth', 'data'), ] ) def login_verdict(url, auth_data): print(url, auth_data) return [\"https://dash.plotly.com\"] Prevent update of outputs In case you do not need to refresh all values in a callback, you can tell plotly that it should keep the previous value, and thus it will not trigger other callback that depend on that value.\nOtherwise if you’d set the same value as before, then dash would think, that a new value have arrived, and calls the next callbacks in the chain.\nThere are 2 types of preventions:\n prevent any kind of update in the callback. It is called PreventUpdate, it should be raised as an exception do not update a single value it is called no_update, it should be returned as a value  Clientside callback In javascript:\n return window.dash_clientside.no_update throw window.dash_clientside.PreventUpdate  Serverside callbacks In python:\nfrom dash.exceptions import PreventUpdate import dash @app.callback(...) def callback_prevent_all(): raise PreventUpdate @app.callback(...) def callback_prevent_some(): return [any_value, dash.no_update, any_other_value] Store simple runtime data We should not use global variables in plotly python code, since it will be changed for all users.\nWe can use global variables in javascript, since it will be only used for that client, but only for that one browser tab.\nIn case we want to share arbitrary data between the clientside and serverside, we can create a hidden div, and set it’s data attributes. It can be accessed in Input, Output and State of callbacks.\nReference https://dash.plotly.com/dash-html-components/div\n data-* (string; optional): A wildcard data attribute\n import dash_html_components as html html.Div(id=\"hidden-data-value\", style=dict(display=\"none\"), **{ \"data-value-1\": \"hello\", \"data-value-2\": \"false\" }),  Note: the values stored in data-attributes are strings.\n One simple usecase is if you have a quickly changing data, you can store it in JS global variable, and have a clientside callback that stores it in a data prop of a div every 100ms, and then you can react to its changes in these fixed sampled times even from python code.\ndcc.Store Docs: Store\nA better way to handle shared data is dash_core_components.Store.\nIt can store data in:\n memory storage_type='memory' (default) localstorage storage_type='local' sessionstorage storage_type='session'  Empty value is None, I prefer to store dict in this type, can not store list since it is not JSON enumerable, but it can be embedded in a dict.\nHandle URL Some basic examples, and concepts: urls\nReference for Location element\nCallback context Docs: Callback context\nIf an input triggers a callback to run, by default you won’t have an idea of which component triggered it. Luckily now callback contexts are available, and you can split your logic across that information as well.\n# inside a callback ctx = dash.callback_context if not ctx.triggered: trigger_id = '-' else: trigger_id = ctx.triggered[0]['prop_id'].split('.')[0] ctx_msg = json.dumps({ 'states': ctx.states, 'triggered': ctx.triggered, 'inputs': ctx.inputs }, indent=2) Custom components If you need custom behavior and you’re not afraid of react, I strongly advise you to create custom components. Basically write only React.js code.\nDefined props can be updated with the usual callbacks, it can tell dash, that it’s input data has changed, and trigger other callbacks that depend on that data.\nBenefits I think in general it’s a good idea to keep the callback graph clean and small, custom components can dramatically decrease graph size.\nIt will be easier to comprehend the application flow and you can encapsulate complex logic.\nIt will speed up development, people can develop the custom components separately, and test them in a sandbox environment.\nDownside The downside of custom components is that you need to define the components' DOM structure yourself, style them consistently, even if there’s an existing dash component that does the exact same thing that you’d need.\nIt’s tricky to keep it consistent with the development environment, if you use bootstrap or enterprise dash-design-kit.\nGetting started   Getting started\n  Create custom component boilerplate:\npip install cookiecutter \u0026\u0026 cookiecutter https://github.com/plotly/dash-component-boilerplate.git   Loading state Docs: loading\nDash renderer lets your custom component know if it is in a loading state, you can get that info with these properties.\n/** * Object that holds the loading state object coming from dash-renderer */ loading_state: PropTypes.shape({ /** * Determines if the component is loading or not */ is_loading: PropTypes.bool, /** * Holds which property is loading */ prop_name: PropTypes.string, /** * Holds the name of the component that is loading */ component_name: PropTypes.string, }), How to use loading component If you wrap your component(s) inside dash_core_components.Loading, then there will be a common loading indicator around them if any children is waiting for a callback response.\nfrom dash_core_components import Loading layout = Loading(children=[MyComponent(id=\"my-comp\")]) Update callback In case your custom component makes changes that should trigger a dash callback, you can use setProps callback with the updated props.\n/** * Dash-assigned callback that should be called to report property changes * to Dash, to make them available for callbacks. */ setProps: PropTypes.func; For example:\ninput value={myProperty} onChange={ /* * Send the new value to the parent component. * setProps is a prop that is automatically supplied * by dash's front-end (\"dash-renderer\"). * In a Dash app, this will update the component's * props and send the data back to the Python Dash * app server if a callback uses the modified prop as * Input or State. */ (e) = setProps({ myProperty: e.target.value }) } /  Note: In dash callbacks you can not use a prop in two callbacks as an Output, but this is somewhat an exception. You can update any input parameters of your component, even if other components use it as an Output.\n Build \u0026 deploy Run python setup.py sdist to build the app into a bundle, you can add the dist into requirements.txt even as a tar.gz file. But it’s better to publish it into your preferred pip artifactory.\nYou do not need to edit ANY python files yourself, all documentation and property validation are generated from the definition and comments of propTypes in your react component.\nNote that it comes with different dependencies and a separate virtual env, you need to install:\n frontend dependencies with npm install python dependencies with pip install   Note, that if you have a dash app, that already uses your component, and you make changes, it’s not enough to build a new package, you need to increment the version number in package.json e.g with npm version patch\n Development You can run tests (separate dependencies, python3 tests/test_usage.py), create a mini dash app (usage.py)\nnpm start is a really useful command to fire up a live reload webpack dev server to develop your react code in isolation.\nNote that the styles are probably going to be different then where it’s going to run, since you might use dash-design-kit or bootstrap-components. But you can customize the demo index.js to look similar to the environment that you depend on, it won’t be added to the final deployment.\nDev tools Docs: Dash devtools\nIt can significantly improve developer experience to turn on the developer tools.\nLivereload, error messages in the dashboard, callback graph with proper information about the current run, and many more.\nserver = app.server if __name__ == \"__main__\": debug_mode = True if os.getenv(\"DEBUG\", \"false\") == \"true\" else False if debug_mode is True: print(f\"Initiating server. Debug mode enabled.\") else: ## Use enable_dev_tools when you want to turn on certain features when deploying your application with gunicorn. # app.enable_dev_tools( # dev_tools_ui=True, # dev_tools_serve_dev_bundles=True, # ) print(f\"Initiating server.\") app.run_server( debug=debug_mode, host=\"0.0.0.0\", port=5000 ) Annoying errors  Exception has occurred: SyntaxError expression cannot contain assignment, perhaps you meant \"==\"?, you most probably missed a comma at the end of a line duing editing the the layout. Exception has occured: SystemExit. You can ignore this. In VSCode livereload triggers this error.  Metadata/Docs At first I started to develop using a very old dash version, and migration was not an option. I looked for solutions to common problems online, but many times they were not suited for my stack.\nIt helped me a lot to get to know the components in github source. You can see the installed python packages as well. They follow the same format, and are self-documented. It’s easy to see which properties were available on the installed versions.\nUsed versions There might be better ways since I wrote this developer summary, The versions I used at the time of writing:\nPlotly version: 1.58.4 Dash version: 1.19.0 dash-core-components: 1.15.0 dash-html-components: 1.1.2 Disclaimer I was not asked for this post, I’m not affiliated with plotly in any way.\nHappy coding!\n","wordCount":"2322","inLanguage":"en","image":"https://budavariam.github.io/images/2021-04-05-plotly-dash-development-tips/cover.png","datePublished":"2021-04-05T00:00:00Z","dateModified":"2021-04-05T00:00:00Z","author":{"@type":"Person","name":"Mátyás Budavári"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://budavariam.github.io/posts/2021/04/05/plotly-dash-development-tips/"},"publisher":{"@type":"Organization","name":"Mátyás Budavári","logo":{"@type":"ImageObject","url":"https://budavariam.github.io/favicon/favicon.ico"}}}</script>
<script src=https://cdn.lr-ingest.io/LogRocket.min.js crossorigin=anonymous></script>
<script>window.LogRocket&&window.LogRocket.init('0igxfm/budavariam-blog'),window.LogRocket.getSessionURL(function(a){ga('send',{hitType:'event',eventCategory:'LogRocket',eventAction:a})})</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://budavariam.github.io/ title="Mátyás Budavári (Alt + H)" class=site-avatar>
<img src=/avatar.png alt=logo aria-label=logo height=70 width=70></a>
<div class=site-info>
<h1 class=site-name>
<a href=https://budavariam.github.io/ accesskey=h title="Mátyás Budavári (Alt + H)">Mátyás Budavári</a>
</h1>
<p class=site-description>Developer from Szeged</p>
</div>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://budavariam.github.io/about/ title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://budavariam.github.io/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://budavariam.github.io/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://budavariam.github.io/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://budavariam.github.io/projects/ title=Projects>
<span>Projects</span>
</a>
</li><li>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Plotly Dash Development Tips
</h1>
<div class=post-meta>
April 5, 2021&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Mátyás Budavári
|&nbsp;<a class=edit-post href=https://github.com/budavariam/budavariam.github.io/blob/main/content/posts/2021-04-05-plotly-dash-development-tips.md rel="noopener noreferrer" target=_blank>Make it better</a></div>
</header>
<figure class=entry-cover><img src=https://budavariam.github.io/images/2021-04-05-plotly-dash-development-tips/cover.png alt="Cover photo from https://plotly.com/dash/">
</figure>
<div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul><li>
<a href=#useful-links-for-getting-started aria-label="Useful links for getting started">Useful links for getting started</a></li><li>
<a href=#dash-clientside-callbacks aria-label="Dash clientside callbacks">Dash clientside callbacks</a><ul>
<li>
<a href=#access-plotly-events-in-dash aria-label="Access plotly events in dash">Access plotly events in dash</a></li><li>
<a href=#unsubscribe-from-events aria-label="Unsubscribe from events">Unsubscribe from events</a></li><li>
<a href=#all-possible-events aria-label="All possible events">All possible events</a><ul>
<li>
<a href=#my-extraction-method aria-label="My extraction method">My extraction method</a></li></ul>
</li></ul>
</li><li>
<a href=#dynamic-update aria-label="Dynamic update">Dynamic update</a><ul>
<li>
<a href=#downside-of-interval aria-label="Downside of interval">Downside of interval</a></li></ul>
</li><li>
<a href=#animations aria-label=Animations>Animations</a></li><li>
<a href=#state-vs-input aria-label="State vs Input">State vs Input</a></li><li>
<a href=#prevent-update-of-outputs aria-label="Prevent update of outputs">Prevent update of outputs</a><ul>
<li>
<a href=#clientside-callback aria-label="Clientside callback">Clientside callback</a></li><li>
<a href=#serverside-callbacks aria-label="Serverside callbacks">Serverside callbacks</a></li></ul>
</li><li>
<a href=#store-simple-runtime-data aria-label="Store simple runtime data">Store simple runtime data</a><ul>
<li>
<a href=#dccstore aria-label=dcc.Store>dcc.Store</a></li></ul>
</li><li>
<a href=#handle-url aria-label="Handle URL">Handle URL</a></li><li>
<a href=#callback-context aria-label="Callback context">Callback context</a></li><li>
<a href=#custom-components aria-label="Custom components">Custom components</a><ul>
<li>
<a href=#benefits aria-label=Benefits>Benefits</a></li><li>
<a href=#downside aria-label=Downside>Downside</a></li><li>
<a href=#getting-started aria-label="Getting started">Getting started</a></li><li>
<a href=#loading-state aria-label="Loading state">Loading state</a></li><li>
<a href=#how-to-use-loading-component aria-label="How to use loading component">How to use loading component</a></li><li>
<a href=#update-callback aria-label="Update callback">Update callback</a></li></ul>
</li><li>
<a href=#build--deploy aria-label="Build &amp;amp; deploy">Build & deploy</a></li><li>
<a href=#development aria-label=Development>Development</a><ul>
<li>
<a href=#dev-tools aria-label="Dev tools">Dev tools</a></li><li>
<a href=#annoying-errors aria-label="Annoying errors">Annoying errors</a></li></ul>
</li><li>
<a href=#metadatadocs aria-label=Metadata/Docs>Metadata/Docs</a><ul>
<li>
<a href=#used-versions aria-label="Used versions">Used versions</a></li></ul>
</li><li>
<a href=#disclaimer aria-label=Disclaimer>Disclaimer</a></li></ul>
</div>
</details>
</div>
<div class=post-content>
<p>Last year I was working on some dash-plotly applications/dashboards.
It was confusing at first, I learned a lot during that time, I&rsquo;d like to share my gathered experience.
The docs already contain useful information, I do not wish to repeat them.
There are many example pages in github, my goal is to collect my most visited pages here,
so it&rsquo;ll be easier to start out with development.</p>
<h2 id=useful-links-for-getting-started>Useful links for getting started<a hidden class=anchor aria-hidden=true href=#useful-links-for-getting-started>#</a></h2>
<ul>
<li><a href=https://dash.plotly.com/layout>dash.plotly.com/layout</a> dash tutorials and concepts, great starting point
<ul>
<li><a href=https://dash.plotly.com/basic-callbacks>dash.plotly.com/basic-callbacks</a> Info on callbacks</li>
<li><a href=https://dash.plotly.com/callback-gotchas>dash.plotly.com/callback-gotchas</a>. Note the rules of callbacks. They&rsquo;re important, so I copy them here:
<ul>
<li>Callbacks require their Inputs, States, and Output to be present in the layout</li>
<li>Callbacks require <code>all</code> Inputs and States to be rendered on the page</li>
<li>A component/property pair can only be the Output of <code>one</code> callback</li>
<li><code>All</code> callbacks must be defined before the server starts</li>
<li>All Dash Core Components in a layout should be registered with a callback.
<ul>
<li>legacy rule</li>
</ul>
</li>
<li>Callback Definitions Don&rsquo;t Need To Be In Lists
<ul>
<li>I prefer lists, since it&rsquo;s easy to forget to add it to all return values when switching around</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://plotly.com/python/>plotly.com/python</a> a lot of plotly examples</li>
<li><a href=https://plotly.com/python/reference/>plotly.com/python/reference</a> very useful reference docs on the available properties</li>
<li><a href=https://github.com/plotly/plotly.js/*>github.com/plotly/plotly.js</a> plotly.js git repo: issues and source code are gold</li>
<li><a href=https://github.com/plotly/dash-recipes>github.com/plotly/dash-recipes</a> recipes for advanced usecases</li>
<li><a href=https://github.com/ucg8j/awesome-dash>github.com/ucg8j/awesome-dash</a> curated list of further reading material, libs, talks and more</li>
<li>tutorial to clear up confusion about <a href=https://chart-studio.plotly.com/~empet/15366/customdata-for-a-few-plotly-chart-types/#/>customdata hovertemplate</a></li>
<li>optional:
<ul>
<li><a href=https://dash-bootstrap-components.opensource.faculty.ai/>dash-bootstrap-components</a> 3rd party responsive components</li>
<li><a href=https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf>pandas cheatsheet</a></li>
</ul>
</li>
</ul>
<h2 id=dash-clientside-callbacks>Dash clientside callbacks<a hidden class=anchor aria-hidden=true href=#dash-clientside-callbacks>#</a></h2>
<p><a href=https://dash.plotly.com/clientside-callbacks>https://dash.plotly.com/clientside-callbacks</a></p>
<blockquote>
<p>Note: All examples use a single output, but we can pass an array as return value</p>
</blockquote>
<p>Some examples can be found <a href=https://github.com/plotly/dash/blob/dev/tests/integration/clientside/test_clientside.py>here (test_clientside.py)</a></p>
<ul>
<li>If you do not want to update a value return <strong>window.dash_clientside.no_update</strong></li>
<li>If you do not want to update <em>at all</em> in that callback <code>throw</code> <strong>window.dash_clientside.PreventUpdate</strong> as an exception</li>
</ul>
<h3 id=access-plotly-events-in-dash>Access plotly events in dash<a hidden class=anchor aria-hidden=true href=#access-plotly-events-in-dash>#</a></h3>
<blockquote>
<p>Note: the events can only be accessed from clientside.</p>
</blockquote>
<p><a href=https://plotly.com/javascript/plotlyjs-events/>This</a> document shows what you can do with plotly events.</p>
<p>If you define a callback that is called <em>after</em> the figure has been created/updated, you can subscribe to the plot events</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#75715e>// works if the plot&#39;s id is main-plot
</span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>plotlyGraph</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#main-plot .js-plotly-plot&#34;</span>);
<span style=color:#a6e22e>plotlyGraph</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;plotly_animatingframe&#34;</span>, (<span style=color:#a6e22e>anim</span>) =&gt;
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(
    <span style=color:#e6db74>&#34;Frame: %s, frameData: %o, animationSettings: %o&#34;</span>,
    <span style=color:#a6e22e>anim</span>.<span style=color:#a6e22e>name</span>,
    <span style=color:#a6e22e>anim</span>.<span style=color:#a6e22e>frame</span>,
    <span style=color:#a6e22e>anim</span>.<span style=color:#a6e22e>animation</span>
  )
);
</code></pre></div><blockquote>
<p>Note: if you register an eventlistener multiple times it will call its callback multiple times (as you told them to)</p>
</blockquote>
<blockquote>
<p>Note: you can only subscribe to events if the plot has appeared in the DOM</p>
</blockquote>
<h3 id=unsubscribe-from-events>Unsubscribe from events<a hidden class=anchor aria-hidden=true href=#unsubscribe-from-events>#</a></h3>
<p>Plotly.js uses a NodeJS style EventEmitter API</p>
<p><a href=https://github.com/plotly/plotly.js/blob/bae378a79bfce17463aed0f70402e4b9cf50ca3c/src/lib/events.js#L56-L57>Source code</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#a6e22e>graphDiv</span>.<span style=color:#a6e22e>removeListener</span>(<span style=color:#e6db74>&#34;plotly_click&#34;</span>, <span style=color:#a6e22e>handler</span>);
<span style=color:#a6e22e>graphDiv</span>.<span style=color:#a6e22e>removeAllListeners</span>(<span style=color:#e6db74>&#34;plotly_click&#34;</span>);
</code></pre></div><h3 id=all-possible-events>All possible events<a hidden class=anchor aria-hidden=true href=#all-possible-events>#</a></h3>
<p>Here&rsquo;s the list of all available events extracted from the source code:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#e6db74>&#34;plotly_afterexport&#34;</span>;
<span style=color:#e6db74>&#34;plotly_afterplot&#34;</span>;
<span style=color:#e6db74>&#34;plotly_animated&#34;</span>;
<span style=color:#e6db74>&#34;plotly_animating&#34;</span>;
<span style=color:#e6db74>&#34;plotly_animatingframe&#34;</span>;
<span style=color:#e6db74>&#34;plotly_animationinterrupted&#34;</span>;
<span style=color:#e6db74>&#34;plotly_autosize&#34;</span>;
<span style=color:#e6db74>&#34;plotly_beforeexport&#34;</span>;
<span style=color:#e6db74>&#34;plotly_buttonclicked&#34;</span>;
<span style=color:#e6db74>&#34;plotly_click&#34;</span>;
<span style=color:#e6db74>&#34;plotly_clickannotation&#34;</span>;
<span style=color:#e6db74>&#34;plotly_deselect&#34;</span>;
<span style=color:#e6db74>&#34;plotly_doubleclick&#34;</span>;
<span style=color:#e6db74>&#34;plotly_framework&#34;</span>;
<span style=color:#e6db74>&#34;plotly_hover&#34;</span>;
<span style=color:#e6db74>&#34;plotly_react&#34;</span>;
<span style=color:#e6db74>&#34;plotly_redraw&#34;</span>;
<span style=color:#e6db74>&#34;plotly_relayout&#34;</span>;
<span style=color:#e6db74>&#34;plotly_relayouting&#34;</span>;
<span style=color:#e6db74>&#34;plotly_restyle&#34;</span>;
<span style=color:#e6db74>&#34;plotly_selected&#34;</span>;
<span style=color:#e6db74>&#34;plotly_selecting&#34;</span>;
<span style=color:#e6db74>&#34;plotly_sliderchange&#34;</span>;
<span style=color:#e6db74>&#34;plotly_sliderend&#34;</span>;
<span style=color:#e6db74>&#34;plotly_sliderstart&#34;</span>;
<span style=color:#e6db74>&#34;plotly_transitioned&#34;</span>;
<span style=color:#e6db74>&#34;plotly_transitioning&#34;</span>;
<span style=color:#e6db74>&#34;plotly_transitioninterrupted&#34;</span>;
<span style=color:#e6db74>&#34;plotly_unhover&#34;</span>;
<span style=color:#e6db74>&#34;plotly_update&#34;</span>;
<span style=color:#e6db74>&#34;plotly_webglcontextlost&#34;</span>;

</code></pre></div><h4 id=my-extraction-method>My extraction method<a hidden class=anchor aria-hidden=true href=#my-extraction-method>#</a></h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone git@github.com:plotly/plotly.js.git
cd plotly.js
ag --noheading --nogroup -o --nonumbers --nofile <span style=color:#e6db74>&#34;gd.emit\(&#39;plotly_[^&#39;]+&#39;&#34;</span> | sort -u
</code></pre></div><h2 id=dynamic-update>Dynamic update<a hidden class=anchor aria-hidden=true href=#dynamic-update>#</a></h2>
<p>Docs: <a href=https://dash.plotly.com/live-updates>live-updates</a></p>
<p>In dash in order to change the value of a prop in a callback, you can only respond to other callbacks, and only with one value for one callback. If you periodically need to update a value, you need to have something, that continuously triggers an event (change a prop, that is used as callback input), that you can respond to.</p>
<p>You can use a ticker to call a callback periodically, you can use it&rsquo;s value both in clientside and serverside callbacks</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>dash_core_components</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>dcc</span>
<span style=color:#a6e22e>dcc</span>.<span style=color:#a6e22e>Interval</span>(<span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;my-interval&#39;</span>, <span style=color:#a6e22e>interval</span><span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>)

<span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>clientside_callback</span>(
    <span style=color:#a6e22e>ClientsideFunction</span>(<span style=color:#e6db74>&#39;clientside&#39;</span>, <span style=color:#e6db74>&#39;my-updater-function&#39;</span>),
    [<span style=color:#a6e22e>Output</span>(<span style=color:#e6db74>&#34;change&#34;</span>, <span style=color:#e6db74>&#34;change-this-prop&#34;</span>)],
    [<span style=color:#a6e22e>Input</span>(<span style=color:#e6db74>&#34;my-interval&#34;</span>, <span style=color:#e6db74>&#34;n_intervals&#34;</span>)]
)
</code></pre></div><p>Reference: <a href=https://dash.plotly.com/dash-core-components/interval>https://dash.plotly.com/dash-core-components/interval</a></p>
<blockquote>
<p>Note: If you set the attributes of a DOM item from arbitrary js code, e.g. event handlers, it won&rsquo;t trigger a callback.</p>
</blockquote>
<p>You can only respond to callback with one value, here&rsquo;s where this component shines, it lets you periodically call a callback, and set any other value.</p>
<h3 id=downside-of-interval>Downside of interval<a hidden class=anchor aria-hidden=true href=#downside-of-interval>#</a></h3>
<p>The ticker will communicate with the server in the given interval, if you need a fast dashboard this might not be the best idea, to sync the state with the dash server. It will most likely degrade performance with more and more users.</p>
<p>If you have the option to pass down all the necessary data, with clientside callbacks and global variables in javascript code, you can create lightning fast dashboards.</p>
<h2 id=animations>Animations<a hidden class=anchor aria-hidden=true href=#animations>#</a></h2>
<p>Docs: <a href=https://plotly.com/python/animations/>animations</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>plotlyGraph</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#34;#main-plot .js-plotly-plot&#34;</span>);
<span style=color:#a6e22e>plotlyGraph</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;plotly_animated&#34;</span>, (<span style=color:#a6e22e>a</span>) =&gt;
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;animation has finished plotly_animated event&#34;</span>, <span style=color:#a6e22e>a</span>)
);
<span style=color:#a6e22e>plotlyGraph</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;plotly_animating&#34;</span>, (<span style=color:#a6e22e>a</span>) =&gt;
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;animation has started plotly_animating event&#34;</span>, <span style=color:#a6e22e>a</span>)
);
<span style=color:#a6e22e>plotlyGraph</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;plotly_animatingframe&#34;</span>, (<span style=color:#a6e22e>a</span>) =&gt;
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;call on each frame plotly_animatingframe event&#34;</span>, <span style=color:#a6e22e>a</span>)
);
<span style=color:#a6e22e>plotlyGraph</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;plotly_animationinterrupted&#34;</span>, (<span style=color:#a6e22e>a</span>) =&gt;
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;pause btn clicked plotly_animationinterrupted event&#34;</span>, <span style=color:#a6e22e>a</span>)
);
</code></pre></div><h2 id=state-vs-input>State vs Input<a hidden class=anchor aria-hidden=true href=#state-vs-input>#</a></h2>
<p>Docs: <a href=https://community.plotly.com/t/what-is-the-difference-between-input-and-state/35219>forum post</a></p>
<p>The <code>@app.callback</code> decorator can have 3 parameters, Inputs, Outputs, and States.
Input triggers a refresh on change, State does not, only use the latest version of the value, that is available when the callback runs.</p>
<p>When you load the page for the first time, all callbacks will be called with the initial value.
If you calculate default values in the beginning, and you want to use them in an other callback, then if you add them as an <code>Input</code>, it will wait for that data, BUT if you add it as a <code>State</code> it won&rsquo;t wait for it, it will use the data that has been calculated until that point that your callback has been called.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>callback(
    output<span style=color:#f92672>=</span>[
        <span style=color:#75715e># the result of the callback will set the given prop on the given element </span>
        Output(<span style=color:#e6db74>&#39;my-link&#39;</span>, <span style=color:#e6db74>&#39;href&#39;</span>),
    ],
    inputs<span style=color:#f92672>=</span>[
        <span style=color:#75715e># if it changes it triggers a callback call</span>
        Input(<span style=color:#e6db74>&#39;url&#39;</span>, <span style=color:#e6db74>&#39;search&#39;</span>), 
    ],
    state<span style=color:#f92672>=</span>[
        <span style=color:#75715e># if it changes it does not trigger a callback call</span>
        <span style=color:#75715e># but the value is available as a prameter</span>
        State(<span style=color:#e6db74>&#39;strava-auth&#39;</span>, <span style=color:#e6db74>&#39;data&#39;</span>),
    ]
)
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login_verdict</span>(url, auth_data):
  print(url, auth_data)
  <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#34;https://dash.plotly.com&#34;</span>]
</code></pre></div><h2 id=prevent-update-of-outputs>Prevent update of outputs<a hidden class=anchor aria-hidden=true href=#prevent-update-of-outputs>#</a></h2>
<p>In case you do not need to refresh all values in a callback, you can tell plotly that it should keep the previous value, and thus it will not trigger other callback that depend on that value.</p>
<p>Otherwise if you&rsquo;d set the same value as before, then dash would think, that a new value have arrived, and calls the next callbacks in the chain.</p>
<p>There are 2 types of preventions:</p>
<ul>
<li>prevent any kind of update in the callback. It is called <code>PreventUpdate</code>, it should be <code>raised</code> as an exception</li>
<li>do not update a single value it is called <code>no_update</code>, it should be <code>returned</code> as a value</li>
</ul>
<h3 id=clientside-callback>Clientside callback<a hidden class=anchor aria-hidden=true href=#clientside-callback>#</a></h3>
<p>In javascript:</p>
<ul>
<li><code>return window.dash_clientside.no_update</code></li>
<li><code>throw window.dash_clientside.PreventUpdate</code></li>
</ul>
<h3 id=serverside-callbacks>Serverside callbacks<a hidden class=anchor aria-hidden=true href=#serverside-callbacks>#</a></h3>
<p>In python:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#f92672>from</span> dash.exceptions <span style=color:#f92672>import</span> PreventUpdate
<span style=color:#f92672>import</span> dash

<span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>callback(<span style=color:#f92672>...</span>)
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>callback_prevent_all</span>():
    <span style=color:#66d9ef>raise</span> PreventUpdate

<span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>callback(<span style=color:#f92672>...</span>)
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>callback_prevent_some</span>():
    <span style=color:#66d9ef>return</span> [any_value, dash<span style=color:#f92672>.</span>no_update, any_other_value]
</code></pre></div><h2 id=store-simple-runtime-data>Store simple runtime data<a hidden class=anchor aria-hidden=true href=#store-simple-runtime-data>#</a></h2>
<p>We should not use global variables in plotly python code, since it will be changed for all users.</p>
<p>We can use global variables in javascript, since it will be only used for that client, but only for that one browser tab.</p>
<p>In case we want to share arbitrary data between the clientside and serverside, we can create a hidden div, and set it&rsquo;s <a href=https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes>data attributes</a>. It can be accessed in Input, Output and State of callbacks.</p>
<p>Reference <a href=https://dash.plotly.com/dash-html-components/div>https://dash.plotly.com/dash-html-components/div</a></p>
<blockquote>
<p>data-* (string; optional): A wildcard data attribute</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>dash_html_components</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>html</span>
<span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>Div</span>(<span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden-data-value&#34;</span>, <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#a6e22e>dict</span>(<span style=color:#a6e22e>display</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;none&#34;</span>), <span style=color:#f92672>**</span>{
  <span style=color:#e6db74>&#34;data-value-1&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;hello&#34;</span>,
  <span style=color:#e6db74>&#34;data-value-2&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;false&#34;</span>
}),
</code></pre></div><blockquote>
<p>Note: the values stored in data-attributes are strings.</p>
</blockquote>
<p>One simple usecase is if you have a quickly changing data, you can store it in JS global variable, and have a clientside callback that stores it in a <code>data</code> prop of a div every 100ms, and then you can react to its changes in these fixed sampled times even from python code.</p>
<h3 id=dccstore>dcc.Store<a hidden class=anchor aria-hidden=true href=#dccstore>#</a></h3>
<p>Docs: <a href=https://dash.plotly.com/dash-core-components/store>Store</a></p>
<p>A better way to handle shared data is <code>dash_core_components.Store</code>.</p>
<p>It can store data in:</p>
<ul>
<li>memory <code>storage_type='memory'</code> (default)</li>
<li>localstorage <code>storage_type='local'</code></li>
<li>sessionstorage <code>storage_type='session'</code></li>
</ul>
<p>Empty value is <code>None</code>, I prefer to store <code>dict</code> in this type, can not store list since it is not JSON enumerable, but it can be embedded in a dict.</p>
<h2 id=handle-url>Handle URL<a hidden class=anchor aria-hidden=true href=#handle-url>#</a></h2>
<p>Some basic examples, and concepts: <a href=https://dash.plotly.com/urls>urls</a></p>
<p>Reference for <a href=https://dash.plotly.com/dash-core-components/location>Location element</a></p>
<h2 id=callback-context>Callback context<a hidden class=anchor aria-hidden=true href=#callback-context>#</a></h2>
<p>Docs: <a href=https://dash.plotly.com/advanced-callbacks#determining-which-input-has-fired-with-dash.callback_context>Callback context</a></p>
<p>If an input triggers a callback to run, by default you won&rsquo;t have an idea of which component triggered it.
Luckily now callback contexts are available, and you can split your logic across that information as well.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#75715e># inside a callback</span>
ctx <span style=color:#f92672>=</span> dash<span style=color:#f92672>.</span>callback_context
<span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> ctx<span style=color:#f92672>.</span>triggered:
    trigger_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;-&#39;</span>
<span style=color:#66d9ef>else</span>:
    trigger_id <span style=color:#f92672>=</span> ctx<span style=color:#f92672>.</span>triggered[<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;prop_id&#39;</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>0</span>]
ctx_msg <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps({
    <span style=color:#e6db74>&#39;states&#39;</span>: ctx<span style=color:#f92672>.</span>states,
    <span style=color:#e6db74>&#39;triggered&#39;</span>: ctx<span style=color:#f92672>.</span>triggered,
    <span style=color:#e6db74>&#39;inputs&#39;</span>: ctx<span style=color:#f92672>.</span>inputs
}, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</code></pre></div><h2 id=custom-components>Custom components<a hidden class=anchor aria-hidden=true href=#custom-components>#</a></h2>
<p>If you need custom behavior and you&rsquo;re not afraid of react, I strongly advise you to create custom components.
Basically write only React.js code.</p>
<p>Defined props can be updated with the usual callbacks, it can tell dash,
that it&rsquo;s input data has changed, and trigger other callbacks that depend on that data.</p>
<h3 id=benefits>Benefits<a hidden class=anchor aria-hidden=true href=#benefits>#</a></h3>
<p>I think in general it&rsquo;s a good idea to keep the callback graph clean and small, custom components can dramatically decrease graph size.</p>
<p>It will be easier to comprehend the application flow and you can encapsulate complex logic.</p>
<p>It will speed up development, people can develop the custom components separately, and test them in a sandbox environment.</p>
<h3 id=downside>Downside<a hidden class=anchor aria-hidden=true href=#downside>#</a></h3>
<p>The downside of custom components is that you need to define the components' DOM structure yourself, style them consistently,
even if there&rsquo;s an existing dash component that does the exact same thing that you&rsquo;d need.</p>
<p>It&rsquo;s tricky to keep it consistent with the development environment, if you use bootstrap or enterprise dash-design-kit.</p>
<h3 id=getting-started>Getting started<a hidden class=anchor aria-hidden=true href=#getting-started>#</a></h3>
<ul>
<li>
<p><a href=https://dash.plotly.com/plugins>Getting started</a></p>
</li>
<li>
<p>Create custom component boilerplate:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip install cookiecutter <span style=color:#f92672>&amp;&amp;</span> cookiecutter https://github.com/plotly/dash-component-boilerplate.git
</code></pre></div></li>
</ul>
<h3 id=loading-state>Loading state<a hidden class=anchor aria-hidden=true href=#loading-state>#</a></h3>
<p>Docs: <a href=https://dash.plotly.com/dash-core-components/loading>loading</a></p>
<p>Dash renderer lets your custom component know if it is in a loading state, you can get that info with these properties.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#75715e>/**
</span><span style=color:#75715e> * Object that holds the loading state object coming from dash-renderer
</span><span style=color:#75715e> */</span>
<span style=color:#a6e22e>loading_state</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PropTypes</span>.<span style=color:#a6e22e>shape</span>({
    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Determines if the component is loading or not
</span><span style=color:#75715e>     */</span>
    <span style=color:#a6e22e>is_loading</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PropTypes</span>.<span style=color:#a6e22e>bool</span>,
    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Holds which property is loading
</span><span style=color:#75715e>     */</span>
    <span style=color:#a6e22e>prop_name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PropTypes</span>.<span style=color:#a6e22e>string</span>,
    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Holds the name of the component that is loading
</span><span style=color:#75715e>     */</span>
    <span style=color:#a6e22e>component_name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PropTypes</span>.<span style=color:#a6e22e>string</span>,
}),
</code></pre></div><h3 id=how-to-use-loading-component>How to use loading component<a hidden class=anchor aria-hidden=true href=#how-to-use-loading-component>#</a></h3>
<p>If you wrap your component(s) inside <code>dash_core_components.Loading</code>, then there will be a common loading indicator around them if any children is waiting for a callback response.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#f92672>from</span> dash_core_components <span style=color:#f92672>import</span> Loading
layout <span style=color:#f92672>=</span> Loading(children<span style=color:#f92672>=</span>[MyComponent(id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my-comp&#34;</span>)])
</code></pre></div><h3 id=update-callback>Update callback<a hidden class=anchor aria-hidden=true href=#update-callback>#</a></h3>
<p>In case your custom component makes changes that should trigger a dash callback, you can use <code>setProps</code> callback with the updated props.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#75715e>/**
</span><span style=color:#75715e> * Dash-assigned callback that should be called to report property changes
</span><span style=color:#75715e> * to Dash, to make them available for callbacks.
</span><span style=color:#75715e> */</span>
<span style=color:#a6e22e>setProps</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PropTypes</span>.<span style=color:#a6e22e>func</span>;
</code></pre></div><p>For example:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>&lt;<span style=color:#f92672>input</span>
  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>myProperty</span>}
  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{
    <span style=color:#75715e>/*
</span><span style=color:#75715e>     * Send the new value to the parent component.
</span><span style=color:#75715e>     * setProps is a prop that is automatically supplied
</span><span style=color:#75715e>     * by dash&#39;s front-end (&#34;dash-renderer&#34;).
</span><span style=color:#75715e>     * In a Dash app, this will update the component&#39;s
</span><span style=color:#75715e>     * props and send the data back to the Python Dash
</span><span style=color:#75715e>     * app server if a callback uses the modified prop as
</span><span style=color:#75715e>     * Input or State.
</span><span style=color:#75715e>     */</span>
    (<span style=color:#a6e22e>e</span>) =&gt; <span style=color:#a6e22e>setProps</span>({ <span style=color:#a6e22e>myProperty</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span> })
  }
/&gt;
</code></pre></div><blockquote>
<p>Note: In dash callbacks you can not use a prop in two callbacks as an <code>Output</code>, but this is somewhat an exception.
You can update any input parameters of your component, even if other components use it as an <code>Output</code>.</p>
</blockquote>
<h2 id=build--deploy>Build & deploy<a hidden class=anchor aria-hidden=true href=#build--deploy>#</a></h2>
<p>Run <code>python setup.py sdist</code> to build the app into a bundle, you can add the dist into <code>requirements.txt</code> even as a <code>tar.gz</code> file.
But it&rsquo;s better to publish it into your preferred pip artifactory.</p>
<p>You <strong>do not need to edit ANY python files</strong> yourself, all documentation and property validation are generated from the definition and comments of <code>propTypes</code> in your react component.</p>
<p>Note that it comes with different dependencies and a separate virtual env, you need to install:</p>
<ul>
<li>frontend dependencies with <code>npm install</code></li>
<li>python dependencies with <code>pip install</code></li>
</ul>
<blockquote>
<p>Note, that if you have a dash app, that already uses your component, and you make changes, it&rsquo;s not enough to build a new package, you need to increment the version number in package.json e.g with <code>npm version patch</code></p>
</blockquote>
<h2 id=development>Development<a hidden class=anchor aria-hidden=true href=#development>#</a></h2>
<p>You can run tests (separate dependencies, <code>python3 tests/test_usage.py</code>), create a mini dash app (<code>usage.py</code>)</p>
<p><code>npm start</code> is a really useful command to fire up a live reload webpack dev server to develop your react code in isolation.</p>
<p>Note that the styles are probably going to be different then where it&rsquo;s going to run, since you might use <code>dash-design-kit</code> or <code>bootstrap-components</code>.
But you can customize the <code>demo</code> index.js to look similar to the environment that you depend on, it won&rsquo;t be added to the final deployment.</p>
<h3 id=dev-tools>Dev tools<a hidden class=anchor aria-hidden=true href=#dev-tools>#</a></h3>
<p>Docs: <a href=https://dash.plotly.com/devtools>Dash devtools</a></p>
<p>It can significantly improve developer experience to turn on the developer tools.</p>
<p>Livereload, error messages in the dashboard, callback graph with proper information about the current run, and many more.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>server <span style=color:#f92672>=</span> app<span style=color:#f92672>.</span>server
<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
    debug_mode <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span> <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;DEBUG&#34;</span>, <span style=color:#e6db74>&#34;false&#34;</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>False</span>
    <span style=color:#66d9ef>if</span> debug_mode <span style=color:#f92672>is</span> <span style=color:#66d9ef>True</span>:
        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Initiating server. Debug mode enabled.&#34;</span>)
    <span style=color:#66d9ef>else</span>:
        <span style=color:#75715e>## Use enable_dev_tools when you want to turn on certain features when deploying your application with gunicorn.</span>
        <span style=color:#75715e># app.enable_dev_tools(</span>
        <span style=color:#75715e>#   dev_tools_ui=True,</span>
        <span style=color:#75715e>#   dev_tools_serve_dev_bundles=True,</span>
        <span style=color:#75715e># )</span>
        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Initiating server.&#34;</span>)

    app<span style=color:#f92672>.</span>run_server(
        debug<span style=color:#f92672>=</span>debug_mode,
        host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0.0.0.0&#34;</span>,
        port<span style=color:#f92672>=</span><span style=color:#ae81ff>5000</span>
    )
</code></pre></div><h3 id=annoying-errors>Annoying errors<a hidden class=anchor aria-hidden=true href=#annoying-errors>#</a></h3>
<ul>
<li><code>Exception has occurred: SyntaxError expression cannot contain assignment, perhaps you meant "=="?</code>, you most probably missed a comma at the end of a line duing editing the the layout.</li>
<li><code>Exception has occured: SystemExit</code>. You can ignore this. In VSCode livereload triggers this error.</li>
</ul>
<h2 id=metadatadocs>Metadata/Docs<a hidden class=anchor aria-hidden=true href=#metadatadocs>#</a></h2>
<p>At first I started to develop using a very old dash version, and migration was not an option.
I looked for solutions to common problems online, but many times they were not suited for my stack.</p>
<p>It helped me a lot to get to know the components in github source.
You can see the installed python packages as well. They follow the same format, and are self-documented.
It&rsquo;s easy to see which properties were available on the installed versions.</p>
<h3 id=used-versions>Used versions<a hidden class=anchor aria-hidden=true href=#used-versions>#</a></h3>
<p>There might be better ways since I wrote this developer summary, The versions I used at the time of writing:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>Plotly</span> <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.58</span>.<span style=color:#ae81ff>4</span>
<span style=color:#a6e22e>Dash</span> <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.19</span>.<span style=color:#ae81ff>0</span>
<span style=color:#a6e22e>dash</span><span style=color:#f92672>-</span><span style=color:#a6e22e>core</span><span style=color:#f92672>-</span><span style=color:#a6e22e>components</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.15</span>.<span style=color:#ae81ff>0</span>
<span style=color:#a6e22e>dash</span><span style=color:#f92672>-</span><span style=color:#a6e22e>html</span><span style=color:#f92672>-</span><span style=color:#a6e22e>components</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.1</span>.<span style=color:#ae81ff>2</span>
</code></pre></div><h2 id=disclaimer>Disclaimer<a hidden class=anchor aria-hidden=true href=#disclaimer>#</a></h2>
<p>I was not asked for this post, I&rsquo;m not affiliated with plotly in any way.</p>
<p>Happy coding!</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://budavariam.github.io/tags/plotly/>plotly</a></li>
<li><a href=https://budavariam.github.io/tags/dash/>dash</a></li>
<li><a href=https://budavariam.github.io/tags/python/>python</a></li>
<li><a href=https://budavariam.github.io/tags/javascript/>javascript</a></li>
<li><a href=https://budavariam.github.io/tags/react/>react</a></li>
<li><a href=https://budavariam.github.io/tags/dataviz/>dataviz</a></li>
</ul>
<div class=share-buttons>
<div class=addthis_inline_share_toolbox></div>
<script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-602c2f70bcebfd93"></script>
</div>
</div>
</footer>
<script async data-uid=7d9354cde4 src=https://fabulous-experimenter-1073.ck.page/7d9354cde4/index.js></script>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//budavariam.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</main><footer class=footer>
<span>&copy; 2021 <a href=https://budavariam.github.io/>Mátyás Budavári</a></span>
<span>&#183;</span>
<wbr>
<span>Powered&nbsp;by&nbsp;<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<wbr>
<span>Theme&nbsp;<a href=https://github.com/budavariam/hugo-PaperMod/tree/budavariam rel=noopener target=_blank>PaperMod&nbsp;(custom)</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<script defer src=/assets/js/copybtn.min.3d17062805a1198a8a849f5a026b60ed842595e6574a6ecf2a1fc1c4d5dd5ceb.js integrity="sha256-PRcGKAWhGYqKhJ9aAmtg7YQlleZXSm7PKh/BxNXdXOs="></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>