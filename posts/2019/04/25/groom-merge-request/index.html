<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Groom merge request | Mátyás Budavári</title><meta name=keywords content="programming,git,my-solution"><meta name=description content="Imagine you want to submit a huge merge request (gitlab terminology),
that has many changes from a bunch of commits.
You realize that you don&rsquo;t want to see some changes,
but these changes are not in separate commits, so they can&rsquo;t be easily reverted.
There are a lot of small changes. You don&rsquo;t want to type their reverse, or copy-paste for minutes.
You want to keep the commits, not squash them together in the end.
What would you do?"><meta name=author content="Mátyás Budavári"><meta name=theme-color content="#317EFB"><link rel=canonical href=https://budavariam.github.io/posts/2019/04/25/groom-merge-request/><meta name=google-site-verification content="ocrG4G5ZSn2awC0mgHAsgk2qlhd3IAXCACgWNrqJcwY"><link href=/assets/css/stylesheet.min.536b821496cc315bf86eb61450c5565dad451fc991631c4a4bc87ceb1f91da0c.css integrity="sha256-U2uCFJbMMVv4brYUUMVWXa1FH8mRYxxKS8h86x+R2gw=" rel="preload stylesheet" as=style><link rel=icon href=https://budavariam.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://budavariam.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://budavariam.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://budavariam.github.io/favicon/apple-icon-180x180.png><link rel=mask-icon href=https://budavariam.github.io/favicon/apple-icon-180x180.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-115499513-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Groom merge request"><meta property="og:description" content="Imagine you want to submit a huge merge request (gitlab terminology),
that has many changes from a bunch of commits.
You realize that you don&rsquo;t want to see some changes,
but these changes are not in separate commits, so they can&rsquo;t be easily reverted.
There are a lot of small changes. You don&rsquo;t want to type their reverse, or copy-paste for minutes.
You want to keep the commits, not squash them together in the end.
What would you do?"><meta property="og:type" content="article"><meta property="og:url" content="https://budavariam.github.io/posts/2019/04/25/groom-merge-request/"><meta property="og:image" content="https://budavariam.github.io/avatar.png"><meta property="article:published_time" content="2019-04-25T00:00:00+00:00"><meta property="article:modified_time" content="2019-04-25T00:00:00+00:00"><meta property="og:site_name" content="Mátyás Budavári"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://budavariam.github.io/avatar.png"><meta name=twitter:title content="Groom merge request"><meta name=twitter:description content="Imagine you want to submit a huge merge request (gitlab terminology),
that has many changes from a bunch of commits.
You realize that you don&rsquo;t want to see some changes,
but these changes are not in separate commits, so they can&rsquo;t be easily reverted.
There are a lot of small changes. You don&rsquo;t want to type their reverse, or copy-paste for minutes.
You want to keep the commits, not squash them together in the end.
What would you do?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://budavariam.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Groom merge request","item":"https://budavariam.github.io/posts/2019/04/25/groom-merge-request/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Groom merge request","name":"Groom merge request","description":"Imagine you want to submit a huge merge request (gitlab terminology), that has many changes from a bunch of commits. You realize that you don\u0026amp;rsquo;t want to see some changes, but …","keywords":["programming","git","my-solution"],"articleBody":"Imagine you want to submit a huge merge request (gitlab terminology), that has many changes from a bunch of commits. You realize that you don’t want to see some changes, but these changes are not in separate commits, so they can’t be easily reverted. There are a lot of small changes. You don’t want to type their reverse, or copy-paste for minutes. You want to keep the commits, not squash them together in the end. What would you do?\nI did not want to spend time to find the perfect solution, so I came up with a quick one.\nWhat I really wanted is to see all changes in one commit, that I saw in my merge request, and select the code I wanted to get rid of, then apply these changes to my original branch.\nIn order to achieve that, I got the latest master, created a sandbox branch, squashed my target branch inside it, selected what code I wanted to get rid of, reverted that commit, and cherry picked it to my target branch.\nSANDBOX_BRANCH=sandbox TARGET_BRANCH=target # 1. Get a clear sandbox with recent master git checkout master git pull git checkout -b $SANDBOX_BRANCH ## 2. Get all changes as one commit git merge $TARGET_BRANCH --squash # ... select only the unnecessary code, # ... that you want to revert git add . git commit -m \"Unnecessary code\" git revert HEAD HASH=`git rev-parse --short HEAD` ## 3. Apply the inverse changes, cleanup git checkout $TARGET_BRANCH git cherry-pick $HASH git commit --amend -v # rename commit git branch -D $SANDBOX_BRANCH Enjoy :)\nP.S: Let me know if you have a better idea.\n","wordCount":"273","inLanguage":"en","datePublished":"2019-04-25T00:00:00Z","dateModified":"2019-04-25T00:00:00Z","author":{"@type":"Person","name":"Mátyás Budavári"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://budavariam.github.io/posts/2019/04/25/groom-merge-request/"},"publisher":{"@type":"Organization","name":"Mátyás Budavári","logo":{"@type":"ImageObject","url":"https://budavariam.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://budavariam.github.io/ title="Mátyás Budavári (Alt + H)" class=site-avatar><img src=/avatar.png alt=logo aria-label=logo height=70 width=70></a><div class=site-info><h1 class=site-name><a href=https://budavariam.github.io/ accesskey=h title="Mátyás Budavári (Alt + H)">Mátyás Budavári</a></h1><p class=site-description>Developer from Szeged</p></div></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://budavariam.github.io/about/ title=About><span>About</span></a></li><li><a href=https://budavariam.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://budavariam.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://budavariam.github.io/archives/ title=Archive><span>Archive</span></a></li><li><span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Groom merge request</h1><div class=post-meta>April 25, 2019&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Mátyás Budavári</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner></div></details></div><div class=post-content><p>Imagine you want to <strong>submit a huge merge request</strong> (<em>gitlab terminology</em>),
that has many changes from a bunch of commits.
<strong>You realize that you don&rsquo;t want to see some changes</strong>,
but these changes are not in separate commits, so they can&rsquo;t be easily reverted.
There are a lot of small changes. You don&rsquo;t want to type their reverse, or copy-paste for minutes.
You want to keep the commits, not squash them together in the end.
<strong>What would you do?</strong></p><p>I did not want to spend time to find the perfect solution, so I came up with a quick one.</p><p>What I really wanted is to see all changes in one commit,
that I saw in my merge request, and select the code I wanted
to get rid of, then apply these changes to my original branch.</p><p>In order to achieve that, I got the latest <code>master</code>, created a sandbox branch,
squashed my target branch inside it, selected what code I wanted to get rid of,
reverted that commit, and cherry picked it to my target branch.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>SANDBOX_BRANCH<span style=color:#f92672>=</span>sandbox
TARGET_BRANCH<span style=color:#f92672>=</span>target

<span style=color:#75715e># 1. Get a clear sandbox with recent master</span>
git checkout master
git pull
git checkout -b $SANDBOX_BRANCH

<span style=color:#75715e>## 2. Get all changes as one commit</span>
git merge $TARGET_BRANCH --squash
<span style=color:#75715e># ... select only the unnecessary code,</span>
<span style=color:#75715e># ...   that you want to revert</span>
git add .
git commit -m <span style=color:#e6db74>&#34;Unnecessary code&#34;</span>
git revert HEAD
HASH<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>git rev-parse --short HEAD<span style=color:#e6db74>`</span>

<span style=color:#75715e>## 3. Apply the inverse changes, cleanup</span>
git checkout $TARGET_BRANCH
git cherry-pick $HASH
git commit --amend -v <span style=color:#75715e># rename commit</span>
git branch -D $SANDBOX_BRANCH
</code></pre></div><p>Enjoy :)</p><p>P.S: Let me know if you have a better idea.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://budavariam.github.io/tags/programming/>programming</a></li><li><a href=https://budavariam.github.io/tags/git/>git</a></li><li><a href=https://budavariam.github.io/tags/my-solution/>my-solution</a></li></ul><div class=share-buttons><div class=addthis_inline_share_toolbox></div><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-602c2f70bcebfd93"></script></div></div></footer><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//budavariam.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2021 <a href=https://budavariam.github.io/>Mátyás Budavári</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://github.com/budavariam/hugo-PaperMod rel=noopener target=_blank>PaperMod (custom)</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>